<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kue Ulang Tahun</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 20px;
    }
    img {
      width: 100%;
      max-width: 500px;
      margin-bottom: 20px;
    }
    .text-container {
      font-size: 24px;
      margin-bottom: 20px;
    }
    .buttons {
      margin-top: 20px;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
      margin: 0 10px;
    }
    #button3 {
      display: none; /* Initially hide button3 */
    }
  </style>
</head>
<body>

  <img id="image" src="img/bday1.png" alt="bday">
  <div class="text-container" id="typingText">
    Kamu mendapat kue entah darimana. Apa yang akan kamu lakukan
  </div>

  <div class="buttons">
    <button id="button1" onclick="handleButton1Click()">Tiup lilin</button>
    <button id="button2" onclick="handleButton2Click()">Biarkan</button>
    <button id="button3" onclick="handleButton3Click()">Beri makan kucing</button> <!-- New Button3 -->
  </div>

  <script>
    let typingIndex = 0;
    let button1ClickCount = 0;
    let typingInProgress = false;

    const typingText = "?";

    function typeText() {
      if (typingIndex < typingText.length) {
        document.getElementById('typingText').innerHTML += typingText.charAt(typingIndex);
        typingIndex++;
        setTimeout(typeText, 80);
      }
    }

    function handleButton1Click() {
      const button1 = document.getElementById('button1');
      const button2 = document.getElementById('button2');
      const button3 = document.getElementById('button3');
      
      if (typingInProgress) return;

      button1ClickCount++;

      typingInProgress = true;
      button1.disabled = true;
      button2.disabled = true;
      button3.disabled = true;
      
      switch (button1ClickCount) {
        case 1:
          const newText1 = "Apa yang akan kamu lakukan selanjutnya?";
          typingIndex = 0;
          document.getElementById('typingText').innerHTML = '';
          typeNewText(newText1);
          changeImage('img/bday2.png');
          button1.textContent = "Makan";
          break;
        case 2:
          const newText2 = "Kuenya manis dan enak. Apa yang akan kamu lakukan selanjutnya?";
          typingIndex = 0;
          document.getElementById('typingText').innerHTML = '';
          typeNewText(newText2);
          changeImage('img/bday3-2.png');
          button1.textContent = "Lanjut makan";
          break;
        case 3:
          const newText3 = "Kamu mulai merasa kenyang. Apa yang akan kamu lakukan selanjutnya?";
          typingIndex = 0;
          document.getElementById('typingText').innerHTML = '';
          typeNewText(newText3);
          changeImage('img/bday4.png');
          break;
        case 4:
          const newText4 = "Tinggal satu potong! Ada kucing yang perlahan mendekatimu. Apa yang akan kamu lakukan selanjutnya?";
          typingIndex = 0;
          document.getElementById('typingText').innerHTML = '';
          typeNewText(newText4);
          changeImage('img/bday5.png');
          button1.textContent = "Makan sendiri";
          break;
        case 5:
          const newText5 = "Kamu menemukan surat dibawah kue! Apa yang akan kamu lakukan selanjutnya?";
          typingIndex = 0;
          document.getElementById('typingText').innerHTML = '';
          typeNewText(newText5);
          changeImage('img/bday6.png');
          button1.textContent = 'Baca surat';
          button3.style.display = 'none';
          button2.style.display = 'none'; // Hides the second button when the action happens
          break;
        default:
          break;
      }
      
      // Show button3 after the 4th click
      if (button1ClickCount === 4) {
        document.getElementById('button3').style.display = 'inline-block'; // Show button3 after the 4th click
      }
    }
    
    function handleButton2Click() {
      const button1 = document.getElementById('button1');
      const button2 = document.getElementById('button2');
      const button3 = document.getElementById('button3');

      if (typingInProgress) return; // Prevent button click if typing is in progress
      typingInProgress = true; // Mark typing as in progress
      button2.disabled = true; // Disable the button to prevent fast clicking
      button1.style.display = 'none';
      button2.style.display = 'none';
      button3.style.display = 'none';
      changeImage('img/bday0.png');
      const newText0 = "Kue dimakan orang.";
      typingIndex = 0;
      document.getElementById('typingText').innerHTML = '';
      typeNewText(newText0);
    }

    function handleButton3Click() {
      const button1 = document.getElementById('button1');
      const button2 = document.getElementById('button2');
      const button3 = document.getElementById('button3');
      if (typingInProgress) return; // Prevent button click if typing is in progress
      typingInProgress = true; // Mark typing as in progress
      button2.disabled = true;
      button1.disabled = true;
      button3.disabled = true;
      // Add functionality for button3 when clicked (for example, feeding the cat)
      const newText7 = "Kucing menyukai strawberry yang kamu berikan. Apa yang akan kamu lakukan selanjutnya? (+1 poin)";
      typingIndex = 0;
      document.getElementById('typingText').innerHTML = '';
      typeNewText(newText7);
      changeImage('img/bday5-2.png');
      button1.textContent = "Makan";
      button2.style.display = 'none';
      button3.style.display = 'none';
    }

    function typeNewText(newText) {
      typingInProgress = true;
      if (typingIndex < newText.length) {
        document.getElementById('typingText').innerHTML += newText.charAt(typingIndex);
        typingIndex++;
        setTimeout(() => typeNewText(newText), 80);
      } else {
        typingInProgress = false;
        document.getElementById('button1').disabled = false;
        document.getElementById('button2').disabled = false;
        document.getElementById('button3').disabled = false;
      }
    }

    function changeImage(imageUrl) {
      document.getElementById('image').src = imageUrl;
    }

    window.onload = typeText;
  </script>

</body>
</html>
