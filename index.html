<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kue Ulang Tahun</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 20px;
    }
    img {
      width: 100%;
      max-width: 500px;
      margin-bottom: 20px;
    }
    .text-container {
      font-size: 24px;
      margin-bottom: 20px;
    }
    .buttons {
      margin-top: 20px;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
      margin: 0 10px;
    }
  </style>
</head>
<body>

  <img id="image" src="img/bday1.png" alt="bday">
  <div class="text-container" id="typingText">
    Kamu mendapat kue entah darimana. Apa yang akan kamu lakukan
  </div>

  <div class="buttons">
    <button id="button1" onclick="handleButton1Click()">Tiup lilin</button>
    <button id="button2" onclick="handleButton2Click()">Biarkan</button>
  </div>

  <script>
    let typingIndex = 0;
    let button1ClickCount = 0;
    let typingInProgress = false;

    const typingText = "?";

    function typeText() {
      if (typingIndex < typingText.length) {
        document.getElementById('typingText').innerHTML += typingText.charAt(typingIndex);
        typingIndex++;
        setTimeout(typeText, 80);
      }
    }

    function handleButton1Click() {
      const button1 = document.getElementById('button1');
      const button2 = document.getElementById('button2');
      
      if (typingInProgress) return;

      button1ClickCount++;

      typingInProgress = true;
      button1.disabled = true;
      button2.disabled = true;
      
      switch (button1ClickCount) {
        case 1:
          const newText1 = "Apa yang akan kamu lakukan selanjutnya?";
          typingIndex = 0;
          document.getElementById('typingText').innerHTML = '';
          typeNewText(newText1);
          changeImage('img/bday2.png');
          button1.textContent = "Makan";
          break;
        case 2:
          const newText2 = "Kuenya manis dan enak. Apa yang akan kamu lakukan selanjutnya?";
          typingIndex = 0;
          document.getElementById('typingText').innerHTML = '';
          typeNewText(newText2);
          changeImage('img/bday3-2.png');
          button1.textContent = "Lanjut makan";
          break;
        case 3:
          const newText3 = "Kamu mulai merasa kenyang. Apa yang akan kamu lakukan selanjutnya?";
          typingIndex = 0;
          document.getElementById('typingText').innerHTML = '';
          typeNewText(newText3);
          changeImage('img/bday4.png');
          break;
        case 4:
          const newText4 = "Tinggal satu potong! Ada kucing yang perlahan mendekatimu. Apa yang akan kamu lakukan selanjutnya?";
          typingIndex = 0;
          document.getElementById('typingText').innerHTML = '';
          typeNewText(newText4);
          changeImage('img/bday5.png');
          button1.textContent = "Makan sendiri";
          button2.style.display = 'none'; // Hides the second button when the action happens
          newButton.style.display = 'none';
          break;
        case 5:
          const newText5 = "Kamu menemukan surat dibawah kue! Apa yang akan kamu lakukan selanjutnya?";
          typingIndex = 0;
          document.getElementById('typingText').innerHTML = '';
          typeNewText(newText5);
          changeImage('img/bday6.png');
          button2.style.display = 'none'; // Hides the second button when the action happens
          newButton.style.display = 'none';
          break;
        default:
          break;
      }
    }

    function addnewButton() {
  const newButton = document.createElement('button');
  newButton.textContent = "Beri makan kucing";
  newButton.id = "newButton"; // Add id
  newButton.onclick = function() {
    if (typingInProgress) return; // Prevent button click if typing is in progress
    typingInProgress = true; // Mark typing as in progress
    changeImage('img/bday5-2.png');
    const newText6 = "Kamu memberikan strawberry. Kucing menyukainya. (+1)";
    typingIndex = 0;
    document.getElementById('typingText').innerHTML = '';
    typeNewText(newText6);
    setTimeout(function() {
      document.getElementById('button1').textContent = "Makan";
    }, newText6.length * 20);

    // Wait until typing is done, then remove the button and update button1 text
    setTimeout(() => {
      // After typing ends, remove the new button
      newButton.remove(); 

      // Change button1 text content to "Makan"
       
    }, newText6.length * 5); // Wait until typing ends before removing button
  };
  
  const buttonContainer = document.querySelector('.buttons');
  buttonContainer.appendChild(newButton);
}

    function handleButton2Click() {
      const button1 = document.getElementById('button1');
      const button2 = document.getElementById('button2');

      if (typingInProgress) return; // Prevent button click if typing is in progress
      typingInProgress = true; // Mark typing as in progress
      button2.disabled = true; // Disable the button to prevent fast clicking
      button1.style.display = 'none';
      button2.style.display = 'none';
      changeImage('img/bday0.png');
      const newText0 = "Kue dimakan orang.";
      typingIndex = 0;
      document.getElementById('typingText').innerHTML = '';
      typeNewText(newText0);
    }

    function typeNewText(newText) {
      typingInProgress = true;
      if (typingIndex < newText.length) {
        document.getElementById('typingText').innerHTML += newText.charAt(typingIndex);
        typingIndex++;
        setTimeout(() => typeNewText(newText), 80);
      } else {
        typingInProgress = false;
        document.getElementById('button1').disabled = false;
        document.getElementById('button2').disabled = false;

        // Only show the new button after typing is done
        if (button1ClickCount === 4) {
          addnewButton(); // Show the button after the typing is done
        }
      }
    }

    function changeImage(imageUrl) {
      document.getElementById('image').src = imageUrl;
    }

    window.onload = typeText;
  </script>

</body>
</html>
